---
// biome-ignore lint/correctness/noUnusedVariables: Used in define:vars directive
const locale = {
  supported: (globalThis as any).__ASTRO_I18N_CONFIG__?.locales?.map((l: any) => l.code) || [],
  default: (globalThis as any).__ASTRO_I18N_CONFIG__?.default || "en",
}
---

<script is:inline define:vars={locale}>
  const currentPath = window.location.pathname;
  const firstSegment = currentPath.split("/")[1];

  if (!locale.supported.includes(firstSegment)) {
    const pathWithoutLocale = currentPath.startsWith("/")
      ? currentPath
      : "/" + currentPath;
    const redirectPath = `/${locale.default}${pathWithoutLocale}`;
    window.location.replace(redirectPath);
  }
</script>