---
import { Locale } from "../lib/locale"

// biome-ignore lint/correctness/noUnusedVariables: Used in define:vars directive
const locale = {
  supported: Locale.supported,
  default: Locale.default,
}
---

<script is:inline define:vars={locale}>
  const currentPath = window.location.pathname;
  const firstSegment = currentPath.split("/")[1];

  // If the first segment is not a supported locale, redirect to default
  if (!locale.supported.includes(firstSegment)) {
    const pathWithoutLocale = currentPath.startsWith("/")
      ? currentPath
      : "/" + currentPath;
    const redirectPath = `/${locale.default}${pathWithoutLocale}`;
    window.location.replace(redirectPath);
  }
</script>