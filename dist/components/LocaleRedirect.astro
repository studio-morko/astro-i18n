---
---

<script>
  import { Locale } from "@mannisto/astro-i18n";
  
  // Wait for the page to load and configuration to be injected
  function checkAndRedirect() {
    // Check if configuration is available
    if (globalThis.__ASTRO_I18N_CONFIG__) {
      const currentPath = window.location.pathname;
      const firstSegment = currentPath.split("/")[1];

      if (!Locale.supported.includes(firstSegment)) {
        const pathWithoutLocale = currentPath.startsWith("/")
          ? currentPath
          : "/" + currentPath;
        const redirectPath = `/${Locale.default}${pathWithoutLocale}`;
        window.location.replace(redirectPath);
      }
    } else {
      // If configuration not ready, try again in a moment
      setTimeout(checkAndRedirect, 10);
    }
  }
  
  document.addEventListener('DOMContentLoaded', checkAndRedirect);
</script>